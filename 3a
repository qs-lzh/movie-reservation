package service

import (
	"github.com/qs-lzh/movie-reservation/internal/model"
	"github.com/qs-lzh/movie-reservation/internal/repository"
	"gorm.io/gorm"
)

type ShowtimeSeatService interface {
	CreateShowtimeSeat(showtimeSeat *model.ShowtimeSeat) error
	GetShowtimeSeatByID(id uint) (*model.ShowtimeSeat, error)
	GetShowtimeSeatByShowtimeID(showtimdID uint) ([]model.ShowtimeSeat, error)
	GetShowtimeSeatByStatus(status model.ShowtimeSeatStatus) ([]model.ShowtimeSeat, error)
	DeleteShowtimeSeatByID(id uint) error
}

type showtimeSeatService struct {
	db   *gorm.DB
	repo repository.ShowtimeSeatRepo
}

func NewshowtimeSeatService(db *gorm.DB) *showtimeSeatService {
	return &showtimeSeatService{
		db:   db,
		repo: repository.NewshowtimeSeatRepoGorm(db),
	}
}

var _ ShowtimeSeatService = (*showtimeSeatService)(nil)

func (s *showtimeSeatService) CreateShowtimeSeat(showtimeSeat *model.ShowtimeSeat) error {
	if err := s.repo.Create(showtimeSeat); err != nil {
		return err
	}
	return nil
}

func (s *showtimeSeatService) GetShowtimeSeatByID(id uint) (*model.ShowtimeSeat, error) {
	showtimeSeat, err := s.repo.GetByID(id)
	if err != nil {
		return nil, err
	}
	return showtimeSeat, nil
}

func (s *showtimeSeatService) GetShowtimeSeatByShowtimeID(showtimeID uint) ([]model.ShowtimeSeat, error) {
	showtimeSeats, err := s.repo.GetByShowtimeID(showtimeID)
	if err != nil {
		return nil, err
	}
	return showtimeSeats, nil
}

func (s *showtimeSeatService) GetShowtimeSeatByStatus(status model.ShowtimeSeatStatus) ([]model.ShowtimeSeat, error) {
	return s.repo.GetByStatus(status)
}

func (s *showtimeSeatService) DeleteShowtimeSeatByID(id uint) error {
	return= s.repo.DeleteByID(id)

}
